(function($) {
    "use strict";
    $(document).ready(function() {
        var cookies = document.cookie;
        if (cookies.indexOf("has_js") >= 0) {
            document.cookie = "has_js=1;secure;";
        }
        $(".listwrapper img").each(function() {
            var highestBox = $(".listwrapper img").height();
            $(this).height(highestBox);
        });
        $(".pane-menu-menu-information ul li.expanded").wrapInner('<div class="li-wrapper"></div>');
        $(".pane-menu-menu-information a.active").on("click", function(e) {
            e.preventDefault();
        });
        $(".follow-us__list-item a").attr("target", "_blank");
        $(".success-stories__image img").each(function() {
            var thisurl = $(this).attr("src");
            $(this).parent(".success-stories__image").css("background-image", "url(" + thisurl + ")");
        });
        $(".listserv-subscribe-block").each(function() {
            if ($(this).html().indexOf("Please enter a valid email") > -1) {
                $(".row").addClass("highlighted-error");
            }
        });
        if (location.search.indexOf("op=Subscribe") > -1) {
            var scrollheight = document.body.scrollHeight;
            var offset = 1100;
            window.scrollTo(0, scrollheight - offset);
        }
        $(".panels-flexible-region-new-facets-inside .pane-title, .sidebarnav_wrapper .pane-title").on("click", function() {
            $(this).next(".pane-content").toggle();
            $(this).toggleClass("open");
        });
        $(".taxonomy-terms li").each(function() {
            var taxclass = "-" + $(this).text().toLowerCase().replace(" ", "-");
            $(this).addClass(taxclass);
        });
        var adjust_font_size = function(inc) {
            var curSize = parseInt($("#mainid article *").css("font-size")) + inc;
            if (curSize <= 22) {
                $("#mainid p, #mainid li, #mainid article *, #mainid article p").css("font-size", curSize);
            }
        };
        $(".incfont").click(function() {
            event.preventDefault();
            adjust_font_size(1);
        });
        $(".decfont").click(function() {
            event.preventDefault();
            adjust_font_size(-1);
        });
        $(window).keydown(function(event) {
            var keycode = event.keyCode ? event.keyCode : event.which;
            switch (keycode) {
              case 187:
                adjust_font_size(1);
                break;

              case 189:
                adjust_font_size(-1);
                break;
            }
        });
        var $images = jQuery("article.node-abstract.node-teaser .image");
        if ($images.find("img").size() > 0) {
            $images.show();
        }
        $("nav.left-off-canvas-menu li.expanded a.active").next("ul.menu").addClass("show");
        $("nav.left-off-canvas-menu li.expanded a.active").parents("li.expanded").find("a.active").addClass("open");
        $(".block-search-form").clone().insertAfter(".mobile-menu").removeClass("header").addClass("mobile-search hidden-for-large-up");
        $(".search-toggle").click(function() {
            $(".mobile-search").toggleClass("show");
        });
        $('<span class="mplus"/>').insertAfter("ul.menu li.expanded > a");
        $(".mplus").on("click", function() {
            $(this).toggleClass("open").next("ul.menu").slideToggle();
            $(this).parents("li").addClass("ulopen");
        });
        $("li .expanded .active").next(".mplus").addClass("open").next("ul.menu").addClass("show");
        $(".mplus.open").parent().addClass("active");
        $("li.active").parent().addClass("show");
        $("ul.menu.show").parent().addClass("active");
        $("li.leaf a.active.open").parent().addClass("active");
        $("li.leaf.active, li.expanded.active").parent().addClass("show");
        $("ul.show").parent().addClass("active");
        $("li.active").parent().addClass("show");
        $('<span class="sidebar-mobile-link hide-for-large-up">Find Other Available Technologies</span>').prependTo("body.section-availabletechnologies .sidebarnav_wrapper");
        $(".sidebar-mobile-link").on("click", function() {
            $("* .sidebarnav_wrapper .block-panels-mini, .sidebarnav_wrapper .inside").slideToggle();
            $(this).toggleClass("open");
        });
        var value = $(".mobile-search .form-item-search-block-form label").attr("for");
        $(".mobile-search .form-item-search-block-form label").attr("for", value + "m");
        value = $(".mobile-search .form-item-search-block-form input").attr("id");
        $(".mobile-search .form-item-search-block-form input").attr("id", value + "m");
        $(".left-off-canvas-menu a, .right-off-canvas-menu a, .mobile-menu a").attr("tabindex", "-1");
        var path = "https://www.cancer.gov/policies/linking";
        var altText = "Exit Disclaimer";
        $("a").filter(function() {
            return /^https?\:\/\/([a-zA-Z0-9\-]+\.)+/.test(this.href) && !/^https?\:\/\/([a-zA-Z0-9\-]+\.)+hhs\.gov/.test(this.href) && !/^https?\:\/\/([a-zA-Z0-9\-]+\.)+nih\.gov/.test(this.href) && !/^https?\:\/\/([a-zA-Z0-9\-]+\.)+usa\.gov/.test(this.href) && !/^https?\:\/\/([a-zA-Z0-9\-]+\.)+cancer\.gov/.test(this.href) && this.href != "" && this.href.indexOf(location.protocol + "//" + location.hostname) != 0 && $(this).parents(".follow-us").length == 0;
        }).after(' <a class="exitNotification" href=' + path + "><img title=" + '"' + altText + '"' + "  alt=" + '"' + altText + '"' + ' src="/sites/all/modules/contrib/extlink/extlink.png" /></a>');
        if ($(".with-image").length == 0) {
            $(".list-spacer-image").addClass("image-collapsed");
            $(".list-item-with-image").addClass("text-collapsed");
        }
    });
})(jQuery);

(function() {
    "use strict";
    var facets_expanded = [];
    jQuery(document).ready(function() {
        (function() {
            var path = location.pathname.split("/");
            if (path[path.length - 1] === "all") {
                return;
            }
            var baseWithFacets = path.slice(0, -1).join("/") + "/all" + location.search;
            jQuery(".facet-selection > li").not(":has(a)").wrapInner('<a href="' + baseWithFacets + '">');
        })();
        (function() {
            var sortClass = "abstract-sort";
            function addClassList() {
                var className = this.className;
                var tooltip = this.textContent.trim();
                var $this = jQuery(this);
                var newClasses = [];
                var regexSortName = new RegExp("edit-" + sortClass + "-(.*)-(?:asc|desc)", "i");
                var regexSelected = /\bselected\b/i;
                var regexAscending = /\basc\b/i;
                var regexDescending = /\bdesc\b/i;
                newClasses.push("-" + className.match(regexSortName)[1]);
                if (regexSelected.test(className)) {
                    newClasses.push("is-selected");
                }
                if (regexAscending.test(className)) {
                    newClasses.push("-ascending");
                } else if (regexDescending.test(className)) {
                    newClasses.push("-descending");
                }
                $this.addClass(newClasses.join(" "));
                $this.children("a").attr({
                    "data-tooltip": "",
                    "aria-haspopup": true,
                    title: tooltip
                });
            }
            jQuery(".form-item-" + sortClass + " .form-type-bef-link").each(addClassList).children("a").addClass("edit-sort__link").wrapInner('<span class="element-invisible">');
            jQuery(document).foundation();
        })();
    });
    if (typeof Drupal.facetapi != "undefined") {
        Drupal.facetapi.makeCheckbox = function() {
            var $link = jQuery(this);
            var isActive = $link.hasClass("facetapi-active");
            if (isActive) {
                $link.closest(".pane-content").prev().addClass("open");
                $link.closest(".pane-content").show();
            }
            var isInactive = $link.hasClass("facetapi-inactive");
            if (!isActive && !isInactive) {
                return;
            }
            var id = this.id + "--checkbox";
            var isDisabled = $link.hasClass("facetapi-zero-results");
            var description = $link.contents().filter(function() {
                return this.nodeType === 3;
            })[0].nodeValue;
            var $container = jQuery('<div class="checkbox">');
            var $label = jQuery('<label for="' + id + '">' + description + "</label>");
            var $checkbox = jQuery('<input type="checkbox" class="facetapi-checkbox" id="' + id + '">');
            var href = $link.attr("href");
            var redirect = new Drupal.facetapi.Redirect(href);
            var filterAction;
            $checkbox.click(function(e) {
                Drupal.facetapi.disableFacet($link.parents("ul.facetapi-facetapi-checkbox-links"));
                redirect.gotoHref();
            });
            if (isActive) {
                $checkbox.prop("checked", true);
                filterAction = Drupal.t("Remove filter for: ");
            } else {
                filterAction = Drupal.t("Apply filter for: ");
            }
            if (isDisabled) {
                $checkbox.prop("disabled", true);
            }
            $label.prepend('<span class="element-invisible">' + filterAction + "</span>");
            $container.append($checkbox).append($label);
            $link.after($container).remove();
        };
    }
})();

(function($) {
    "use strict";
    $(document).ready(function() {
        $("#edit-abstract-sort-search-api-aggregation-2-desc a").prepend('<i class="fa fa-sort-numeric-desc" aria-hidden="true"></i>');
        $("#edit-abstract-sort-search-api-aggregation-2-asc a").prepend('<i class="fa fa-sort-numeric-asc" aria-hidden="true"></i>');
        $("#edit-abstract-sort-field-opp-start-date-asc a").prepend('<i class="fa fa-calendar-check-o" aria-hidden="true"></i>');
        $("#edit-abstract-sort-field-opp-start-date-desc a").prepend('<i class="fa fa-calendar" aria-hidden="true"></i>');
        $("#edit-abstract-sort-changed-asc a").prepend('<i class="fa fa-calendar-plus-o" aria-hidden="true"></i>');
        $("#edit-abstract-sort-changed-desc a").prepend('<i class="fa fa-calendar-minus-o" aria-hidden="true"></i>');
        $("#edit-abstract-sort-search-api-aggregation-1-asc a").prepend('<i class="fa fa-sort-alpha-asc" aria-hidden="true"></i>');
        $("#edit-abstract-sort-search-api-aggregation-1-desc a").prepend('<i class="fa fa-sort-alpha-desc" aria-hidden="true"></i>');
        $(".pane-facetapi .pane-title").wrapInner("<a href='#' class='facet-type'></a>");
        $(".pane-facetapi .pane-title a").focus(function() {
            $(this).parents(".pane-facetapi").children(".pane-content").toggle();
            $(this).parent(".pane-title").toggleClass("open");
        });
        $(".pane-facetapi .facetapi-checkbox").focus(function() {
            $(this).parent(".checkbox").css({
                "border-color": "#7777ff",
                "border-width": "1px",
                "border-style": "solid"
            });
        }).focusout(function() {
            $(this).parent(".checkbox").css("border", "none");
        });
    });
})(jQuery);